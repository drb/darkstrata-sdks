# DarkStrata Technology Add-on - Adaptive Response Actions
# These actions can be triggered from Splunk ES notable events or correlation searches

# ============================================================================
# Update Alert Status in DarkStrata
# ============================================================================
[darkstrata_update_alert_status]
is_custom = 1
label = DarkStrata: Update Alert Status
description = Update the status of a credential exposure alert in DarkStrata (ACTIVE, UNDER_INVESTIGATION, CLOSED)
icon_path = appicon.png
payload_format = json
disabled = 0

# CAM (Common Action Model) settings for ES Adaptive Response
param._cam = {"technology": [{"vendor": "DarkStrata", "product": "DarkStrata", "version": "1.0"}], "category": ["Information Conveyance"], "supports_adhoc": true, "task": ["update"], "subject": ["threat intelligence"]}

# Parameters
param.account =
param.alert_id =
param.status =

# ============================================================================
# Close Alert in DarkStrata
# ============================================================================
[darkstrata_close_alert]
is_custom = 1
label = DarkStrata: Close Alert
description = Close a credential exposure alert in DarkStrata, marking investigation complete
icon_path = appicon.png
payload_format = json
disabled = 0

# CAM settings for ES Adaptive Response
param._cam = {"technology": [{"vendor": "DarkStrata", "product": "DarkStrata", "version": "1.0"}], "category": ["Information Conveyance"], "supports_adhoc": true, "task": ["update"], "subject": ["threat intelligence"]}

# Parameters
param.account =
param.alert_id =

# ============================================================================
# Reopen Alert in DarkStrata
# ============================================================================
[darkstrata_reopen_alert]
is_custom = 1
label = DarkStrata: Reopen Alert
description = Reopen a previously closed alert in DarkStrata for further investigation
icon_path = appicon.png
payload_format = json
disabled = 0

# CAM settings for ES Adaptive Response
param._cam = {"technology": [{"vendor": "DarkStrata", "product": "DarkStrata", "version": "1.0"}], "category": ["Information Conveyance"], "supports_adhoc": true, "task": ["update"], "subject": ["threat intelligence"]}

# Parameters
param.account =
param.alert_id =

# ============================================================================
# Get Alert Details (Enrichment Action)
# ============================================================================
[darkstrata_get_alert_details]
is_custom = 1
label = DarkStrata: Get Alert Details
description = Retrieve full details of a DarkStrata alert for enrichment
icon_path = appicon.png
payload_format = json
disabled = 0

# CAM settings - read-only enrichment action
param._cam = {"technology": [{"vendor": "DarkStrata", "product": "DarkStrata", "version": "1.0"}], "category": ["Information Gathering"], "supports_adhoc": true, "task": ["enrich"], "subject": ["threat intelligence"]}

# Parameters
param.account =
param.alert_id =
