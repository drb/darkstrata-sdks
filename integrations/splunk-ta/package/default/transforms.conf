# DarkStrata Technology Add-on - Transforms Configuration
# Defines field extractions and lookups for DarkStrata threat intelligence

#
# Extract user account login from STIX observed-data objects
#
[darkstrata_extract_user_account]
REGEX = "account_login"\s*:\s*"([^"]+)"
FORMAT = user::$1

#
# Extract domain from STIX observed-data objects
#
[darkstrata_extract_domain]
REGEX = "type"\s*:\s*"domain-name"[^}]*"value"\s*:\s*"([^"]+)"
FORMAT = dest_domain::$1

#
# Extract source type from labels
#
[darkstrata_extract_source]
REGEX = "source:(malware|breach)"
FORMAT = threat_source::$1

#
# Extract flow direction from labels
#
[darkstrata_extract_flow]
REGEX = "flow:(inbound|outbound)"
FORMAT = flow_direction::$1

#
# Extract severity from labels
#
[darkstrata_extract_severity]
REGEX = "severity-(info|low|medium|high|critical)"
FORMAT = severity::$1

#
# Threat Intel KV Store Lookup - Email Intelligence
# Populates ES Threat Intel Framework email_intel collection
#
[darkstrata_email_intel_lookup]
filename = darkstrata_email_intel.csv
case_sensitive_match = false
match_type = WILDCARD(email)

#
# Threat Intel KV Store Lookup - Domain Intelligence
# Populates ES Threat Intel Framework http_intel collection
#
[darkstrata_domain_intel_lookup]
filename = darkstrata_domain_intel.csv
case_sensitive_match = false
match_type = WILDCARD(domain)

#
# Threat Intel KV Store Lookup - User Intelligence
# Populates ES Threat Intel Framework user_intel collection
#
[darkstrata_user_intel_lookup]
filename = darkstrata_user_intel.csv
case_sensitive_match = false
match_type = WILDCARD(user)
